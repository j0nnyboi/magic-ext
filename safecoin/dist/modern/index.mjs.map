{"version":3,"file":"index.mjs","sources":["../../src/type.ts","../../src/index.ts"],"sourcesContent":["export interface SolanaConfig {\n  rpcUrl: string;\n}\n\nexport enum SolanaPayloadMethod {\n  SignTransaction = 'sol_signTransaction',\n  SendTransaction = 'sol_sendTransaction',\n}\n\nexport interface SerializeConfig {\n  /** Require all transaction signatures be present (default: true) */\n  requireAllSignatures?: boolean;\n  /** Verify provided signatures (default: true) */\n  verifySignatures?: boolean;\n}\n","import { Extension } from '@magic-sdk/commons';\n\n/* eslint-disable no-param-reassign, array-callback-return */\nimport { SolanaConfig, SolanaPayloadMethod, SerializeConfig } from './type';\n\nexport class SolanaExtension extends Extension.Internal<'solana', any> {\n  name = 'solana' as const;\n  config: any = {};\n\n  constructor(public solanaConfig: SolanaConfig) {\n    super();\n\n    this.config = {\n      rpcUrl: solanaConfig.rpcUrl,\n      chainType: 'SOLANA',\n    };\n  }\n\n  public sendAndConfirmTransaction = (transaction: any, options?: any) => {\n    const { instructions } = transaction;\n\n    instructions.map((instruction: any) => {\n      instruction.programId = instruction.programId.toBase58();\n    });\n\n    return this.request({\n      id: 42,\n      jsonrpc: '2.0',\n      method: SolanaPayloadMethod.SendTransaction,\n      params: {\n        instructions,\n        options,\n      },\n    });\n  };\n\n  public signTransaction = (transaction: any, serializeConfig?: SerializeConfig) => {\n    const { instructions } = transaction;\n\n    const magicInstructions = instructions.map((i: any) => {\n      return {\n        ...i,\n        keys: i.keys.map((k: any) => {\n          return { ...k, pubkey: k.pubkey.toBase58() };\n        }),\n        programId: i.programId.toBase58(),\n      };\n    });\n\n    const params = {\n      feePayer: transaction.feePayer.toBase58(),\n      instructions: magicInstructions,\n      recentBlockhash: transaction.recentBlockhash,\n      serializeConfig,\n    };\n\n    return this.request({\n      id: 42,\n      jsonrpc: '2.0',\n      method: SolanaPayloadMethod.SignTransaction,\n      params,\n    });\n  };\n}\n"],"names":["SolanaPayloadMethod","SolanaExtension","Extension","Internal","constructor","solanaConfig","super","name","config","sendAndConfirmTransaction","transaction","options","instructions","map","instruction","programId","toBase58","request","id","jsonrpc","method","SendTransaction","params","signTransaction","serializeConfig","magicInstructions","i","keys","k","pubkey","feePayer","recentBlockhash","SignTransaction","this","rpcUrl","chainType"],"mappings":"kQAIYA,GAAZ,SAAYA,GACVA,wCACAA,wCAFF,CAAYA,IAAAA,aCCCC,UAAwBC,EAAUC,SAI7CC,YAAmBC,GACjBC,aADiBD,yBAHnBE,KAAO,cACPC,OAAc,QAWPC,0BAA4B,CAACC,EAAkBC,KACpD,MAAMC,aAAEA,GAAiBF,EAMzB,OAJAE,EAAaC,IAAKC,IAChBA,EAAYC,UAAYD,EAAYC,UAAUC,kBAGpCC,QAAQ,CAClBC,GAAI,GACJC,QAAS,MACTC,OAAQpB,EAAoBqB,gBAC5BC,OAAQ,CACNV,aAAAA,EACAD,QAAAA,WAKCY,gBAAkB,CAACb,EAAkBc,KAC1C,MAAMZ,aAAEA,GAAiBF,EAEnBe,EAAoBb,EAAaC,IAAKa,QAErCA,GACHC,KAAMD,EAAEC,KAAKd,IAAKe,QACJA,GAAGC,OAAQD,EAAEC,OAAOb,cAElCD,UAAWW,EAAEX,UAAUC,cAIrBM,EAAS,CACbQ,SAAUpB,EAAYoB,SAASd,WAC/BJ,aAAca,EACdM,gBAAiBrB,EAAYqB,gBAC7BP,gBAAAA,GAGF,YAAYP,QAAQ,CAClBC,GAAI,GACJC,QAAS,MACTC,OAAQpB,EAAoBgC,gBAC5BV,OAAAA,KAnDeW,kBAAA5B,EAGjB4B,KAAKzB,OAAS,CACZ0B,OAAQ7B,EAAa6B,OACrBC,UAAW"}